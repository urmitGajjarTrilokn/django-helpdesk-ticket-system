{% extends "Base.html" %}
{% block title %}Reset Password — HelpDesk{% endblock %}

{% block extra_css %}
<style>
  .auth-outer {
    min-height: calc(100vh - 160px);
    display: flex; align-items: center; justify-content: center;
    padding: 32px 16px;
  }
  .auth-card-wrap { width: 100%; max-width: 420px; }

  .auth-card {
    background: #fff;
    border: 1px solid var(--slate-200);
    border-radius: var(--r-lg);
    box-shadow: 0 8px 32px rgba(0,0,0,.07);
    overflow: hidden;
  }

  .auth-head {
    padding: 36px 32px 24px;
    text-align: center;
    border-bottom: 1px solid var(--slate-100);
  }
  .auth-icon-ring {
    width: 68px; height: 68px; border-radius: 50%;
    margin: 0 auto 18px;
    background: var(--brand-light);
    border: 2px solid var(--brand-muted);
    display: flex; align-items: center; justify-content: center;
    font-size: 26px; color: var(--brand);
    animation: popIn .5s cubic-bezier(.34,1.56,.64,1) both;
  }
  .auth-title { font-size: 21px; font-weight: 800; color: var(--slate-900); letter-spacing: -.3px; margin-bottom: 6px; }
  .auth-sub   { font-size: 13.5px; color: var(--slate-500); }

  .auth-body { padding: 26px 32px; }
  .auth-foot { padding: 14px 32px; border-top: 1px solid var(--slate-100); text-align: center; }

  .field-icon-wrap { position: relative; }
  .field-icon-wrap i {
    position: absolute; left: 12px; top: 50%;
    transform: translateY(-50%);
    color: var(--slate-400); font-size: 13px; pointer-events: none;
  }
  .field-icon-wrap input { padding-left: 34px; width: 100%; }

  .how-steps { display: flex; flex-direction: column; gap: 10px; }
  .how-step  { display: flex; align-items: flex-start; gap: 11px; }
  .how-num   {
    width: 22px; height: 22px; border-radius: 50%;
    background: var(--brand); color: #fff;
    font-size: 11px; font-weight: 800;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0; margin-top: 1px;
  }
  .how-text  { font-size: 13px; color: var(--slate-600); line-height: 1.5; }

  .helper-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 12px; }
  .helper-card {
    background: #fff; border: 1px solid var(--slate-200);
    border-radius: var(--r-lg); padding: 14px 12px; text-align: center;
  }

  @keyframes popIn {
    0%   { transform: scale(0);    opacity: 0; }
    60%  { transform: scale(1.12); }
    100% { transform: scale(1);    opacity: 1; }
  }
</style>
{% endblock %}

{% block content %}
<div class="auth-outer">
<div class="auth-card-wrap">

  <div class="auth-card">

    <div class="auth-head">
      <div class="auth-icon-ring"><i class="fas fa-key"></i></div>
      <div class="auth-title">Forgot Password?</div>
      <div class="auth-sub">Enter your email and we'll send you a reset link</div>
    </div>

    <form method="POST" id="resetForm" novalidate>
      {% csrf_token %}
      <div class="auth-body">

        <div class="mb-3">
          <label class="form-label">Email Address <span class="text-danger">*</span></label>
          <div class="field-icon-wrap">
            <i class="fas fa-envelope"></i>
            {{ form.email }}
          </div>
          <div class="form-text">Use the email address you registered with</div>
          {% if form.email.errors %}
            <div class="field-error">{{ form.email.errors.0 }}</div>
          {% endif %}
          <div class="field-error" id="err_email" style="display:none;">Please enter a valid email address.</div>
        </div>

        <div style="background:var(--brand-light);border-left:3px solid var(--brand);
                    border-radius:var(--r);padding:14px 16px;margin-bottom:18px;">
          <div style="font-size:11px;font-weight:800;text-transform:uppercase;
                      letter-spacing:.5px;color:var(--brand);margin-bottom:10px;">
            <i class="fas fa-info-circle me-1"></i> How It Works
          </div>
          <div class="how-steps">
            <div class="how-step">
              <div class="how-num">1</div>
              <div class="how-text">Enter your registered email address</div>
            </div>
            <div class="how-step">
              <div class="how-num">2</div>
              <div class="how-text">Check your inbox for the reset link</div>
            </div>
            <div class="how-step">
              <div class="how-num">3</div>
              <div class="how-text">Click the link and create a new password</div>
            </div>
            <div class="how-step">
              <div class="how-num">4</div>
              <div class="how-text">Sign back in with your new credentials</div>
            </div>
          </div>
        </div>

        <button type="submit" class="btn btn-primary w-100" id="resetBtn"
                style="padding:12px;font-weight:700;font-size:14px;">
          <i class="fas fa-paper-plane me-2"></i>Send Reset Link
        </button>

      </div>
    </form>

    <div class="auth-foot">
      <a href="{% url 'login' %}"
         style="font-size:13px;color:var(--slate-500);text-decoration:none;
                display:inline-flex;align-items:center;gap:6px;transition:color .15s;"
         onmouseover="this.style.color='var(--brand)'"
         onmouseout="this.style.color='var(--slate-500)'">
        <i class="fas fa-arrow-left" style="font-size:11px;"></i>
        Back to Login
      </a>
    </div>

  </div>

  <div class="helper-cards">
    <div class="helper-card">
      <i class="fas fa-clock" style="color:var(--brand);font-size:20px;margin-bottom:8px;display:block;"></i>
      <div style="font-size:12px;font-weight:700;color:var(--slate-700);margin-bottom:3px;">No Email?</div>
      <div style="font-size:11.5px;color:var(--slate-400);line-height:1.4;">Check spam or wait a few minutes</div>
    </div>
    <div class="helper-card">
      <i class="fas fa-shield-alt" style="color:var(--success);font-size:20px;margin-bottom:8px;display:block;"></i>
      <div style="font-size:12px;font-weight:700;color:var(--slate-700);margin-bottom:3px;">Link Expires In</div>
      <div style="font-size:11.5px;color:var(--slate-400);line-height:1.4;">24 hours for your security</div>
    </div>
  </div>

</div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.getElementById('resetForm').addEventListener('submit', function(e) {
    const email = document.getElementById('id_email');
    const err   = document.getElementById('err_email');
    const re    = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

    if (!email || !re.test(email.value.trim())) {
      if (email) email.classList.add('is-invalid');
      err.style.display = 'block';
      e.preventDefault(); return;
    }
    email.classList.remove('is-invalid');
    err.style.display = 'none';

    const btn = document.getElementById('resetBtn');
    btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Sending…';
    btn.disabled  = true;
  });
</script>
{% endblock %}